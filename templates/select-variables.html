<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Variables - SoundDash</title>
    <!-- Local Bootstrap CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
</head>
<body>
    <!-- Clean, Responsive Navbar -->
    <header class="sticky-top">
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="/">
                    <span class="me-2">üîä</span> <strong>SoundDash</strong>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="/">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="/select-variables">Dashboard</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/about">About</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <!-- Page Header -->
    <section class="bg-primary text-white py-4">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8 text-center">
                    <h1 class="h2 fw-bold mb-2">Sound Monitoring Dashboard</h1>
                    <p class="lead">Select variables and date range to visualize urban sound data</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content Section -->
    <section class="py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-white border-0 py-3">
                            <h2 class="h4 mb-0">Select Parameters</h2>
                        </div>
                        <div class="card-body p-4">
                            {% if invalid_date_message %}
                                    <div class="alert alert-warning alert-dismissible fade show shadow-sm mb-4" role="alert">
                                        <div class="d-flex align-items-center">
                                            <span class="me-2">‚ö†Ô∏è</span>
                                            {{ invalid_date_message }}
                                        </div>
                                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                    </div>
                                
                            {% endif %}
                            <!-- Form -->
                            <form method="POST">
                                <div class="row g-4">
                                    <!-- Vari√°vel -->
                                    <div class="col-md-6 mb-4">
                                        <label for="variable" class="form-label fw-bold">Escolha a Vari√°vel:</label>
                                        <div class="input-group">
                                            <span class="input-group-text bg-primary text-white">
                                                <span class="me-2">üìä</span>
                                            </span>
                                            <select name="variable" id="variable" class="form-select py-2" required>
                                                <option value="" disabled selected>Select an acoustic parameter</option>
                                                <option value="LAEA">LAEA</option>
                                                <option value="LCpeak">LCpeak</option>
                                                <option value="LCpeakT">LCpeakT</option>
                                                <option value="LAFmax">LAFmax</option>
                                                <option value="LAFmaxT">LAFmaxT</option>
                                                <option value="LAFmin">LAFmin</option>
                                                <option value="LAFminT">LAFminT</option>
                                                <option value="LAeq">LAeq</option>
                                            </select>
                                        </div>
                                        <small class="text-muted mt-2 d-block">Select the acoustic parameter to monitor</small>
                                    </div>

                                    <!-- Data e Hora Inicial -->
                                    <div class="col-md-6 mb-4">
                                        <label for="start_date" class="form-label fw-bold">Data e Hora Inicial:</label>
                                        <div class="input-group">
                                            <span class="input-group-text bg-primary text-white">
                                                <span class="me-2">üóìÔ∏è</span>
                                            </span>
                                            <input type="datetime-local" id="start_date" name="start_date" class="form-control py-2" required>
                                        </div>
                                        <small class="text-muted mt-2 d-block">Start of monitoring period</small>
                                    </div>
                                </div>

                                <div class="row g-4">
                                    <!-- Data e Hora Final -->
                                    <div class="col-md-6 mb-4">
                                        <label for="end_date" class="form-label fw-bold">Data e Hora Final:</label>
                                        <div class="input-group">
                                            <span class="input-group-text bg-primary text-white">
                                                <span class="me-2">üóìÔ∏è</span>
                                            </span>
                                            <input type="datetime-local" id="end_date" name="end_date" class="form-control py-2" required>
                                        </div>
                                        <small class="text-muted mt-2 d-block">End of monitoring period</small>
                                    </div>
                                </div>

                                <div class="d-flex justify-content-center mt-4">
                                    <button type="submit" class="btn btn-primary btn-lg px-5 py-2">
                                        <span class="me-2">üîç</span> Generate Dashboard
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Dashboard Display -->
                    {% if start_timestamp and end_timestamp %}
                    <div class="card border-0 shadow-sm mt-5">
                        <div class="card-header bg-white border-0 py-3 d-flex justify-content-between align-items-center">
                            <h3 class="h4 mb-0">{{ variable }} Dashboard</h3>
                        </div>
                        <div class="card-body p-0">
                            <div class="dashboard-container bg-light p-2">
                                {% if variable == 'LAEA' %}
                                    <iframe src="http://localhost:3000/d-solo/eej0pdkup3rpce/laea?orgId=1&from={{ start_timestamp }}&to={{ end_timestamp }}&timezone=browser&tab=queries&panelId=1&__feature.dashboardSceneSolo" width="100%" height="600" frameborder="0" class="shadow-sm"></iframe>
                                {% elif variable == 'LCpeak' %}
                                    <iframe src="http://localhost:3000/d-solo/fej0qrt2av8qod/lcpeak?orgId=1&from={{ start_timestamp }}&to={{ end_timestamp }}&timezone=browser&panelId=1&__feature.dashboardSceneSolo" width="100%" height="600" frameborder="0" class="shadow-sm"></iframe>
                                {% elif variable == 'LAFmax' %}
                                    <iframe src="http://localhost:3000/d-solo/eej0qhnp8j5s0b/lafmax?orgId=1&from={{ start_timestamp }}&to={{ end_timestamp }}&timezone=browser&panelId=1&__feature.dashboardSceneSolo" width="100%" height="600" frameborder="0" class="shadow-sm"></iframe>
                                {% elif variable == 'LAeq' %}
                                    <iframe src="http://localhost:3000/d-solo/dej0r21ki3ri8e/laeq?orgId=1&from={{ start_timestamp }}&to={{ end_timestamp }}&timezone=browser&panelId=1&__feature.dashboardSceneSolo" width="100%" height="600" frameborder="0" class="shadow-sm"></iframe>
                                {% elif variable == 'LCpeakT' %}
                                    <iframe src="http://localhost:3000/d-solo/bej0rd0dtua68d/lcpeakt?orgId=1&from={{ start_timestamp }}&to={{ end_timestamp }}&timezone=browser&panelId=1&__feature.dashboardSceneSolo" width="100%" height="600" frameborder="0" class="shadow-sm"></iframe>
                                {% elif variable == 'LAFmaxT' %}
                                    <iframe src="http://localhost:3000/d-solo/fej2mx82t08hsc/lafmaxt?orgId=1&from={{ start_timestamp }}&to={{ end_timestamp }}&timezone=browser&panelId=1&__feature.dashboardSceneSolo" width="100%" height="600" frameborder="0" class="shadow-sm"></iframe>
                                {% elif variable == 'LAFmin' %}
                                    <iframe src="http://localhost:3000/d-solo/eej2n5j54d1c0a/lafmin?orgId=1&from={{ start_timestamp }}&to={{ end_timestamp }}&timezone=browser&panelId=1&__feature.dashboardSceneSolo" width="100%" height="600" frameborder="0" class="shadow-sm"></iframe>
                                {% else %}
                                    <iframe src="http://localhost:3000/d-solo/eej2nbqw1xm9sf/lafmint?orgId=1&from={{ start_timestamp }}&to={{ end_timestamp }}&timezone=browser&panelId=1&__feature.dashboardSceneSolo" width="100%" height="600" frameborder="0" class="shadow-sm"></iframe>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>

    <!-- Project Partners Section -->
    <section class="py-5 bg-light">
        <div class="container">
            <h2 class="text-center h3 mb-5">Project Partners</h2>
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body p-4 text-center">
                            <h3 class="h5">Instituto Superior de Engenharia de Lisboa</h3>
                            <p class="mb-0 text-muted">LAA ‚Äì Laborat√≥rio de √Åudio e Ac√∫stica do ISEL</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body p-4 text-center">
                            <h3 class="h5">Instituto Polit√©cnico de Beja</h3>
                            <p class="mb-0 text-muted">Academic Research Partner</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-12 mb-4 mb-md-0">
                    <h3 class="h5">SoundDash</h3>
                    <p class="mb-0">Dashboard agregador de eventos sonoros em Smart Cities</p>
                    <p class="small mt-2">Licenciatura em Engenharia Inform√°tica, Redes e Telecomunica√ß√µes<br>
                    Ano-Letivo 2024/2025</p>
                </div>
            </div>
            <hr class="mt-4">
            <div class="text-center">
                <p class="mb-0">&copy; 2025 SoundDash. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Local Bootstrap JS Bundle -->
    <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
    
    <!-- Add this to your style.css file -->
    <style>
        .dashboard-container {
            border-radius: 4px;
            overflow: hidden;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }
        
        .input-group-text {
            font-size: 1.1rem;
        }
        
        .card {
            transition: all 0.3s ease;
        }
        
        .badge {
            font-weight: 500;
        }
    </style>
</body>
</html>